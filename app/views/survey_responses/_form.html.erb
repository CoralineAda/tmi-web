<%= turbo_frame_tag "#{question.key}_#{response.id}" do %>
	<% if success %>
		<% @css_class = success ? "form-success" : "form-error" %>
	<% end %>
	<% key = "#{question.key}-#{response.id}" %>
	<%= form_with model: response, data: { turbo_frame: "#{question.key}_#{response.id}" } do |f| %>
		<div id="code-cloud-<%= key %>">
			<% response.read_attribute(question.codes_field).try(:sort).to_a.each do |code| %>
				<div class="tag <%= @css_class %>"><%= code %></div>
			<% end %>
			<div class="tag tag-button"><a onclick="toggleCodeMode('<%= key %>'); return false;">Edit</a></div>
			<br style="clear: both;" />
		</div>
		<div class="hidden" id="code-entry-<%= key %>">
			<%= f.text_area question.codes_field, value: response.read_attribute(question.codes_field).try(:sort).try(:join, ', '), multiple: true %>
			<%= f.submit "Save", class: "small" %>
		</div>
	<% end %>
<% end %>
